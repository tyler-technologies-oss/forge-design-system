"use strict";(self.webpackChunkforge_design_system=self.webpackChunkforge_design_system||[]).push([[8171],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,s=e.originalType,l=e.parentName,p=a(e,["components","mdxType","originalType","parentName"]),m=c(n),h=o,d=m["".concat(l,".").concat(h)]||m[h]||u[h]||s;return n?r.createElement(d,i(i({ref:t},p),{},{components:n})):r.createElement(d,i({ref:t},p))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var s=n.length,i=new Array(s);i[0]=m;var a={};for(var l in t)hasOwnProperty.call(t,l)&&(a[l]=t[l]);a.originalType=e,a.mdxType="string"==typeof e?e:o,i[1]=a;for(var c=2;c<s;c++)i[c]=n[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},55835:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>s,metadata:()=>a,toc:()=>c});var r=n(87462),o=(n(67294),n(3905));const s={title:"Adopting Container Queries",decription:"Use container queries in your code with a fallback for unsupported browsers.",authors:["sam.richardson"],tags:["forge","css","responsive design"]},i=void 0,a={permalink:"/blog/2023/05/05/adopting-container-queries",editUrl:"https://pr.new/github.com/tyler-technologies-oss/forge-design-system/edit/beta/blog/2023-05-05-adopting-container-queries/index.md",source:"@site/blog/2023-05-05-adopting-container-queries/index.md",title:"Adopting Container Queries",description:"As we move more and more toward responsive design there has been increasing interest in CSS container queries. For those of us who aren\u2019t on the cutting edge of CSS development, container queries are a new feature that allows us to apply styles based on a containing element\u2019s dimensions. This is conceptually similar to typical media queries, which are based instead on the qualities of the viewport as a whole.",date:"2023-05-05T00:00:00.000Z",formattedDate:"May 5, 2023",tags:[{label:"forge",permalink:"/blog/tags/forge"},{label:"css",permalink:"/blog/tags/css"},{label:"responsive design",permalink:"/blog/tags/responsive-design"}],readingTime:3.305,hasTruncateMarker:!0,authors:[{name:"Sam Richardson",title:"Senior Front End Software Engineer",url:"https://github.com/samrichardsontylertech",imageURL:"https://github.com/samrichardsontylertech.png",key:"sam.richardson"}],frontMatter:{title:"Adopting Container Queries",decription:"Use container queries in your code with a fallback for unsupported browsers.",authors:["sam.richardson"],tags:["forge","css","responsive design"]},nextItem:{title:"Enhanced Angular Integration",permalink:"/blog/2023/03/22/angular-proxies"}},l={authorsImageUrls:[void 0]},c=[],p={toc:c};function u(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"As we move more and more toward responsive design there has been increasing interest in CSS container queries. For those of us who aren\u2019t on the cutting edge of CSS development, container queries are a new feature that allows us to apply styles based on a containing element\u2019s dimensions. This is conceptually similar to typical ",(0,o.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/CSS/Media_Queries/Using_media_queries"},"media queries"),", which are based instead on the qualities of the viewport as a whole."),(0,o.kt)("p",null,"It\u2019s easy to see how container queries can make developing flexible layouts easier. The classic demonstration is a single card component that renders differently based on where it is on the page. There\u2019s been enough written on it before that there's no need to repeat here, but check out ",(0,o.kt)("a",{parentName:"p",href:"https://ishadeed.com/article/say-hello-to-css-container-queries/"},"this older but still relevant example"),", ",(0,o.kt)("a",{parentName:"p",href:"https://www.smashingmagazine.com/2021/05/complete-guide-css-container-queries/"},"this writeup in Smashing Magazine"),", and ",(0,o.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Container_Queries"},"MDN\u2019s docs")," for great, in-depth examples."),(0,o.kt)("p",null,"Now is a great time to start incorporating container queries into your code. However, this is still a very recent addition to browsers (supported in Firefox as of February 2023 and other major browsers from September 2022) so it\u2019s smart to set a fallback for users still on older versions."),(0,o.kt)("p",null,"We can use the ",(0,o.kt)("inlineCode",{parentName:"p"},"ForgeResizeObserver")," as that fallback. ",(0,o.kt)("inlineCode",{parentName:"p"},"ForgeResizeObserver")," is a performant utility written around the native ",(0,o.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/API/Resize_Observer_API"},"Resize Observer API")," that notifies us whenever an observed element\u2019s dimensions change."),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"View ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/tyler-technologies-oss/forge-core/blob/main/src/resize/resize-observer.ts"},"the ",(0,o.kt)("inlineCode",{parentName:"a"},"ForgeResizeObserver")," source code here"),".")),(0,o.kt)("p",null,"Let's set up a function to handle this. First, we check to see whether the user agent supports container queries."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"function checkSupportsContainerQueries(): void {\n    if (CSS.supports('container-type', 'inline-size')) {\n        return;\n    }\n}\n")),(0,o.kt)("p",null,"If it doesn\u2019t, we pass in the the container element and register it with the ResizeObserver, setting up a callback function to toggle a class on it when it crosses our breakpoint. Be sure to import ",(0,o.kt)("inlineCode",{parentName:"p"},"ForgeResizeObserver")," from ",(0,o.kt)("inlineCode",{parentName:"p"},"@tylertech/forge-core"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"import { ForgeResizeObserver } from '@tylertech/forge-core';\n\nfunction checkSupportsContainerQueries(el: HTMLElement): void {\n    if (CSS.supports('container-type', 'inline-size')) {\n        return;\n    }\n\n    ForgeResizeObserver.observe(el, entry => {\n        // Set a 600px breakpoint\n        const isSmall = entry.contentRect.width < 600;\n        el.classList.toggle('small', isSmall);\n    });\n}\n")),(0,o.kt)("p",null,"You might also want to debounce the callback if performance is a concern."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"import { debounce, ForgeResizeObserver } from '@tylertech/forge-core';\n\nfunction checkSupportsContainerQueries(el: HTMLElement): void {\n    if (CSS.supports('container-type', 'inline-size')) {\n        return;\n    }\n\n    ForgeResizeObserver.observe(el, entry => {\n        // Run once then wait 100 milliseconds between executions\n        debounce(() => {\n            const isSmall = entry.contentRect.width < 600;\n            el.classList.toggle('small', isSmall);\n        }, 100, true)\n    });\n}\n")),(0,o.kt)("p",null,"In the CSS we simply apply the same styles to this class that we use within the container query."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-scss"},"@mixin small-container-styles() {\n    // Styles to apply when the container is narrow\n}\n\n.container {\n    &.small {\n        @include small-container-styles;\n    }\n\n    @container (inline-size < 600px) {\n        @include small-container-styles;\n    }\n}\n")),(0,o.kt)("p",null,"To avoid memory leaks it\u2019s necessary to clean up the ResizeObserver when the targeted element leaves the DOM. This is simple if your app uses Angular, just call ",(0,o.kt)("inlineCode",{parentName:"p"},"ForgeResizeObserver.unobserve()")," in your component\u2019s ngOnDestroy lifecycle method."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"@Component({})\nclass SomeComponent implements OnDestroy {\n    el: HTMLElement;\n\n    ngOnDestroy(): void {\n        ForgeResizeObserver.unobserve(this.el);\n    }\n}\n")),(0,o.kt)("p",null,"A full Angular component that treats a host element as the container could be written like this."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"import { debounce, ForgeResizeObserver } from '@tylertech/forge-core';\n\n@Component({})\nexport class SomeComponent implements OnInit, OnDestroy {\n    constructor(private _el: ElementRef<HTMLElement>, private _renderer: Renderer2) {}\n\n    ngOnInit(): void {\n        this._checkSupportsContainerQueries();\n    }\n\n    ngOnDestroy(): void {\n        ForgeResizeObserver.unobserve(this._el.nativeElement);\n    }\n\n    private _checkSupportsContainerQueries(): void {\n        if (CSS.supports('container-type', 'inline-size')) {\n            return;\n        }\n\n        ForgeResizeObserver.observe(el, entry => {\n            debounce(() => {\n                const isSmall = entry.contentRect.width < 600;\n                el.classList.toggle('small', isSmall);\n            }, 100, true)\n        });\n    }\n}\n")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Tyler Angular Core also exposes an Angular-specific ",(0,o.kt)("inlineCode",{parentName:"p"},"ResizeObserverDirective"),", but since that can't be easily attached conditionally the frame agnostic ",(0,o.kt)("inlineCode",{parentName:"p"},"ForgeResizeObserver")," is preferable in this case."),(0,o.kt)("p",{parentName:"admonition"},"Learn ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/tyler-technologies/tyler-angular-core/blob/main/projects/core/src/lib/directives/resize-observer/README.md"},"more about the directive here"),".")),(0,o.kt)("p",null,"With this code in place, your users can enjoy a more fluid UI regardless of how up to date their browser is. Of course, this is just one way to use the ResizeObserver. Chances are you\u2019ll run into other scenarios where these tools may be helpful."))}u.isMDXComponent=!0}}]);